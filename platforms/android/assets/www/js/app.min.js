function init(){document.addEventListener("deviceready",onDeviceReady,!1),delete init}function onDeviceReady(){function e(){"true"===window.localStorage.getItem("session")}function a(){$.mobile.activePage.is("#pageDashboard")||($.mobile.activePage.is("#pageLogin")?navigator.app.exitApp():navigator.app.backHistory())}function o(){$("#panelMenu").panel("open")}var t=window.localStorage.getItem("email");$("#panelprofile span").html(t),"true"===window.localStorage.getItem("session")&&(proyectosIniciados(),proyectosCurso(),$.mobile.changePage("#pageDashboard")),document.addEventListener("resume",e,!1),document.addEventListener("backbutton",a,!1),document.addEventListener("menubutton",o,!1),$("#btnLogin").on("click",function(e){return e.preventDefault(),$.ajax({type:"GET",url:baseURI+"/APILogin?jsoncallback=?",data:$("#appLogin").serialize(),dataType:"json",beforeSend:function(){$.mobile.loading("show")},success:function(e){setTimeout(function(){1==e.success?($.mobile.loading("hide"),$.mobile.changePage("#pageDashboard",{transition:"slide"}),console.log(e),window.localStorage.setItem("session","true"),window.localStorage.setItem("nombre",e.nombre),window.localStorage.setItem("username",e.username),window.localStorage.setItem("email",e.email),window.localStorage.setItem("apem",e.apem),window.localStorage.setItem("apep",e.apep),window.localStorage.setItem("date",e.date),proyectosIniciados(),proyectosCurso()):($.mobile.loading("hide"),console.log(e))},1e3)}}),!1}),$("#panelMenu").on("click","#btnLogout",function(e){e.preventDefault(),window.localStorage.clear(),$.mobile.changePage("#pageLogin",{transition:"slide"})}),$("#refreshProjects").on("click",function(e){e.preventDefault(),console.log("ok"),proyectosIniciados(),proyectosCurso()}),$("#projectList").on("click","#item",function(){var e=this.getAttribute("data-id");window.localStorage.setItem("proyecto",e),$.ajax({type:"GET",url:baseURI+"/verProyecto/"+e+"?jsoncallback=?",dataType:"json",success:function(a){console.log(a),$("#menu p").remove(),$.each(a,function(e,a){var o="<p>"+a+"</p>";$(o).appendTo("#"+e),console.log("This is "+e+" , the content is "+a)}),$("#tareas li").remove(),$.ajax({url:baseURI+"/verTareas/"+e+"?jsoncallback=?",type:"GET",dataType:"json",success:function(e){console.log(e),$.each(e,function(e,a){var o=$("<li/>"),t='<a href="#" id="tag" data-idtarea="'+a.Id+'" data-val="'+a.Titulo+'">'+a.Titulo+"</a>";$(t).addClass("ui-btn ui-btn-icon-right ui-icon-carat-r").appendTo(o),o.appendTo("#tareas")}),$.mobile.changePage("#projectPage",{transition:"slide"})}})},complete:function(){$.ajax({url:baseURI+"/updateTarea/"+e+"?jsoncallback=?",dataType:"json",type:"GET",success:function(e){console.log(e)}})}})}),$(".act").on("click","#takepicture",function(e){e.preventDefault(),navigator.camera.getPicture(function(e){alert(e);var a=new FileUploadOptions;a.filekey="file",a.fileName=e.substr(e.lastIndexOf("/")+1),a.mimeType="image/jpeg";var o=new Object;o.value1="test",o.value2="param",a.params=o,a.chunkedMode=!1;var t=new FileTransfer;t.upload(e,encodeURI(baseURI+"/uploadFiles"),win,fail,a),$("#getTake").attr("src",e),window.localStorage.removeItem("nombreImagen"),window.localStorage.setItem("nombreImagen",e.substr(e.lastIndexOf("/")+1)),$.mobile.changePage("#imagePage",{transition:"slide"})},function(e){alert(e)},{quality:50,destinationType:Camera.DestinationType.FILE_URL})}),$("#savepicture").on("click",function(e){e.preventDefault();var a=$("#tituloImage").val(),o=$("#desImage").val(),t=window.localStorage.getItem("nombreImagen"),i=window.localStorage.getItem("tarea");$.ajax({url:baseURI+"/registerImage?jsoncallback=?",type:"GET",data:{titulo:a,descripcion:o,image:t,idtarea:i},dataType:"json",success:function(e){showAlert(e.mensaje,"Subida","Continuar"),$("#tituloImage").val(""),$("#desImage").val(""),$.mobile.changePage("#projectPage",{transition:"slide",reverse:!0})}})}),$("#fotos").on("click","a#getimgUpdate",function(){var e=this.getAttribute("data-imgid");console.log(e),$.ajax({url:baseURI+"/getImageInformation/"+e+"?jsoncallback=?",type:"GET",dataType:"json",success:function(e){console.log(e),$("#getTakeU").attr("src",baseImages+"/"+e[0].NameURL),$("#tituloImageU").val(e[0].Titulo),$("#desImageU").val(e[0].Descripcion)}}),$.mobile.changePage("#imageupdatePage")}),$("#tareas").on("click","a#tag",function(){var e=$(this).data("idtarea"),a=$(this).data("val");console.log(e+" "+a),$("#append-title").remove(),window.localStorage.removeItem("tarea"),window.localStorage.setItem("tarea",e),getImages(),$(".title-activity").append('<p id="append-title">'+a+'<span id="number" style="float: right;">Fotos: </span></p>'),$.mobile.changePage("#activityPage",{transition:"slide"})}),$("#checkSuccess").on("click",function(e){e.preventDefault();var a=window.localStorage.getItem("proyecto");$.ajax({url:baseURI+"/getImagesByWork/"+a+"?jsoncallback=?",type:"GET",dataType:"json",success:function(e){console.log(e),null!==e?e.total==e.objetos.length?(console.log("Iguales: "+e.total+","+e.objetos.length),completarProyecto()):console.log("No son Iguales: "+e.total+","+e.objetos.length):console.log("No puede enviarse a revisión.")}})}),$("#profile1").on("click",function(e){e.preventDefault(),$("#names p").remove(),$("#usr p").remove(),$("#emails p").remove(),$("#date p").remove();var a=window.localStorage.getItem("email"),o=window.localStorage.getItem("nombre"),t=window.localStorage.getItem("apep"),i=window.localStorage.getItem("apem"),s=window.localStorage.getItem("date"),n=window.localStorage.getItem("username");$.mobile.changePage("#pageProfile"),$("#names").append("<p><b>Nombre: </b>"+o+" "+t+" "+i+"</p>"),$("#usr").append("<p><b>Usuario: </b>"+n+"</p>"),$("#emails").append("<p><b>Email: </b>"+a+"</p>"),$("#date").append("<p><b>Fecha: </b>"+s+"</p>")}),$("#bckbutton").on("click",function(e){e.preventDefault(),proyectosIniciados(),proyectosCurso(),$.mobile.changePage("#pageDashboard",{transition:"slide",reverse:!0})}),$("#bckbutton2").on("click",function(e){e.preventDefault(),proyectosIniciados(),proyectosCurso(),$.mobile.changePage("#projectPage",{transition:"slide",reverse:!0})}),$("#bckbutton3").on("click",function(e){e.preventDefault(),$("#getTakeU").attr("src",""),$("#tituloImageU").val(""),$("#desImageU").val(""),$.mobile.changePage("#activityPage")}),$("#panelMenu").trigger("updatelayout"),$("#pageDashboard").swipe(function(){$("#panelMenu").panel("open")}),$("#pageDashboard").swipeLeft(function(){$("#panelMenu").panel("close")})}function alerts(e){alert(e)}function win(e){console.log("Code = "+e.responseCode),console.log("Response  ="+e.response),console.log("Sent = "+e.bytesSent),alert(e.reponse)}function fail(e){alert("An error has ocurred: Code = "+e.code)}function proyectosCurso(){var e=window.localStorage.getItem("email");$.ajax({type:"GET",url:baseURI+"/proyectosCurso?jsoncallback=?",data:{email:e},dataType:"json",beforeSend:function(){$.mobile.loading("show",{theme:"renew"}),$("#refreshProjects span").hide()},success:function(e){if($(".app-append-two").remove(),null!=e)for(var a=0;a<e.length;a++)$("#prosNuevos").after('<li id="item" data-id="'+e[a].id_proyecto+'" class="box waves-effect app-append-two"><div><p><b>Nombre</b></p><p>'+e[a].p_nombre+"</p><p><b>Descripción</b></p><p>"+e[a].p_descri+"</p><p><b>Fecha y Hora: </b>"+e[a].p_fecha+"</p><p><b>Categoría: </b>"+e[a].p_cat+"</p></div></li>");else $("#prosNuevos").after('<li id="item" class="box waves-effect app-append-two"><div><p class="center" style="font-size: .7em;"><span class="icon-info2" style="padding-right: 5px;"></span> No hay proyectos nuevos.</p></div></li>')}})}function proyectosIniciados(){var e=window.localStorage.getItem("email");$.ajax({type:"GET",url:baseURI+"/proyectosIniciados?jsoncallback=?",data:{email:e},dataType:"json",success:function(e){if($(".app-append").remove(),null!=e)for(var a=0;a<e.length;a++)$("#prosIniciados").after('<li id="item" data-id="'+e[a].id_proyectos+'" class="box waves-effect app-append"><div><p><b>Nombre</b></p><p>'+e[a].p_nombre+"</p><p><b>Descripción</b></p><p>"+e[a].p_descri+"</p><p><b>Fecha y Hora: </b>"+e[a].p_fecha+"</p><p><b>Categoría: </b>"+e[a].p_cat+"</p></div></li>");else $("#prosIniciados").after('<li id="item" class="box waves-effect app-append"><div><p class="center" style="font-size: .7em;"><span class="icon-info2" style="padding-right: 5px;"></span> No hay proyectos en curso.</p></div></li>')},complete:function(){$.mobile.loading("hide"),$("#refreshProjects span").show()}})}function getImages(){var e=window.localStorage.getItem("tarea");$.ajax({url:baseURI+"/getWorks/"+e+"?jsoncallback=?",dataType:"json",type:"GET",success:function(e){if(console.log(e),$("#fotos .col-img").remove(),null!=e){window.localStorage.setItem("pictures",e.length);var a=window.localStorage.getItem("pictures");window.localStorage.removeItem("pictures"),$("#number").append(a)}else $("#number").append("0");$.each(e,function(e,a){var o='<a href="#" id="getimgUpdate" data-imgid="'+a.ImageID+'"><div class="col-img"><img src="'+baseImages+"/"+a.URL+'" width="320px" /></div></a>';$(o).appendTo("#fotos")})}})}function completarProyecto(){var e=window.localStorage.getItem("proyecto"),a=window.localStorage.getItem("email");$.ajax({url:baseURI+"/updateProyecto/"+e+"?jsoncallback=?",dataType:"json",data:{email:a},type:"GET",success:function(e){alert(e.message,"Enviado","Regresar"),proyectosIniciados(),proyectosCurso(),$.mobile.changePage("#pageDashboard")}})}function alertDismissed(){}function showAlert(e,a,o){navigator.notification.alert(e,alertDismissed,a,o)}var baseURI="http://192.168.1.75/webapnote/API",baseImages="http://192.168.1.75/webapnote/uploads";